# VibeCoder Codex Amendments (Proposed by Orchestrator)
Based on Lessons Learned from Phase 5 (Dual Core) & Phase 6 (Integration).

## Раздел: Инженерная Дисциплина (Engineering Hard-Rules)

### Принцип №68: Закон "Тактируемого Сброса" (The Clocked Reset Law)
**Контекст:** Инцидент с "Logos Core Timeout".
**Формулировка:** В симуляции RTL (через Verilator/C++) запрещено изменять сигнал сброса (`rst`) без продвижения модельного времени.
**Правило:** Любое изменение `top->rst` в C++ драйвере должно сопровождаться минимум одним вызовом `top->eval()` и переключением `top->clk` (tick). Сброс — это процесс во времени, а не мгновенное состояние.

### Принцип №69: Закон "Обратного Давления" (The Backpressure Law)
**Контекст:** Потеря команд при быстрой отправке (Dropped Commands).
**Формулировка:** Любой интерфейс управления (Control Plane) между C++ и Verilog обязан реализовывать механизм рукопожатия (Handshake: Valid/Ready).
**Правило:** Драйверу ЗАПРЕЩЕНО снимать сигнал `valid` или менять данные, пока устройство не выставило `ready`. Принцип "Fire-and-Forget" (выстрелил и забыл) в аппаратном дизайне запрещен.

### Принцип №70: Закон "DPI-Совместимости Типов" (The DPI Type Safety Law)
**Контекст:** Ошибки с чтением мусора из массивов и `svBitVecVal`.
**Формулировка:** На границе языков (SystemVerilog <-> C++) запрещено использование 4-значной логики (`reg`, `logic`) для данных.
**Правило:** В интерфейсах DPI функций всегда использовать тип `bit` (2-state logic). В C++ никогда не кастить указатели `void*` в `uint64_t*` напрямую — использовать побитовую сборку из 32-битных чанков (`svBitVecVal`).

---

## Раздел: Операционная Гигиена (Operational Hygiene)

### Протокол "Рентген Docker" (The Docker X-Ray Protocol)
**Контекст:** "Молчаливый успех" тестов, когда Docker сворачивает логи, и мы не видим реальных цифр.
**Правило:** Если тест является критическим (Milestone Test), недостаточно просто увидеть `Build Finished`. Инженер ОБЯЗАН запустить тест вручную через `docker run --rm ...`, чтобы своими глазами увидеть логи выполнения (`[PASS]`, счетчики, данные).

### Протокол "Чистого Листа" (The Clean Slate Protocol)
**Контекст:** Ошибки линковки из-за остатков старых `.o` файлов или конфликтующих хедеров при смене архитектуры.
**Правило:** При переходе между Фазами или при возникновении необъяснимых ошибок сборки (CMake/Linker), первым шагом всегда является полное удаление директории сборки (`rm -rf build`) и, при необходимости, `git clean -fd`. Патчинг поверх грязного билда запрещен.

---

## Раздел: Архитектурные Паттерны

### Паттерн "Очередь перед Арбитром" (FIFO-First Arbitration)
**Контекст:** Подготовка к Фазе 7 (Performance).
**Правило:** Арбитр памяти не должен блокировать источник запроса (Master), если память занята другим клиентом. Между Мастером и Арбитром всегда должен стоять буфер (FIFO), развязывающий их по времени. Это необходимо для Pipelining.
